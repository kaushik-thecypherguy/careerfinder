spring.application.name=careerfinder

# --- Postgres ---
spring.datasource.url=jdbc:postgresql://localhost:5432/postgres
spring.datasource.username=postgres
spring.datasource.password=root

# --- Server ---
server.port=8081

# --- OpenAI (optional; leave key empty to skip) ---
openai.api.key=${OPENAI_API_KEY:}
openai.api.model=gpt-4o-mini
openai.api.url=https://api.openai.com/v1/chat/completions

# --- JPA & SQL init (single, clean set) ---
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.default_schema=public

# Make sure data.sql runs AFTER Hibernate creates tables
spring.jpa.defer-datasource-initialization=true

# Do not auto-run SQL init scripts (use Flyway/Liquibase later if needed)
spring.sql.init.mode=never
spring.sql.init.encoding=UTF-8
spring.sql.init.continue-on-error=true

# Admin API secret (Heroku: set env ADMIN_SECRET)
admin.secret=${ADMIN_SECRET}

# Sector config file locations relative to classpath (src/main/resources)
sector.catalog.path=config_sectors_v1/SectorCatalog_v1.json
sector.gates.path=config_sectors_v1/SectorGates_v1.json
sector.weights.path=config_sectors_v1/SectorWeights_v2_3.json

# Validator tolerance for sum(weights)=1.0
sector.weights.rowTolerance=0.001

spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# --- UTF-8 everywhere (HTML + Thymeleaf + messages) ---
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

spring.thymeleaf.encoding=UTF-8

spring.messages.basename=messages
spring.messages.encoding=UTF-8
spring.messages.fallback-to-system-locale=false

# optional but safe (Tomcat URL decoding)
server.tomcat.uri-encoding=UTF-8

# Dev convenience (optional)
spring.thymeleaf.cache=false
spring.messages.cache-duration=1s